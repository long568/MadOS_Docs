(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{187:function(t,n,a){t.exports=a.p+"assets/img/3.41a2c01f.png"},188:function(t,n){t.exports="data:image/png;base64,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"},189:function(t,n,a){t.exports=a.p+"assets/img/5.df7f8b96.png"},190:function(t,n,a){t.exports=a.p+"assets/img/6.47907cfb.png"},191:function(t,n){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKkAAAAmCAIAAAAwUSx1AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC3ElEQVR4nO2avZmjMBCGpfPW4chuAiqwL7no0svkEBewRaDQzraDjeQKvCVsAr3MBRghJCHGNl54npk3gmE0GvTpz8ISAARDk6Vpv16v506BBADwZq/mTcVFSrmofMQiU3oGKaUQ4tfcaTCzwdrThbWnC2tPF9aeLqw9XVh7urD2dGHtX0hzhDKhp+eGjx+FtafLo9rXOpe5rifNhRKyT2ix9kRxr9S9Obw98wKMRyhAaGm+C7hfBx74WND4uwUf0F4CwNI+VPxcPrXWVVHsxh2RKXluYSmMZSiyexvVHt9ojTPh9b7W+fb4PXcWlvSEDwB2wphsYLgRExhlSyjT3ioDAABVmfVjZmXVf9AacIzlc8tFmTZ+L7xXaZecMl3J3gshssM0kecWbdvwNhp5qLpENGSGvdxQxaoyu+kMRjVXRjnaK1fsrkfcGtW14jNL0iiXlVUT3aoXr9SotqMa5QjtvMIEKfXchlQZ7RzpusTYPy0wScLd2vvDI9JwXRNDOBncMfSR2ne9cXAGcvuEHfGpV3gipc4tIWfiAlNXdNzfNeLdgrj1flNcjfo6bqWUh8uAz+WwP2dldXJ2Tm7DXosNqqqniVa6Ka7OJP9KonsuAIhu1txS0d970fhPHulY0Hu93QkAqjI772Pq1zrfn5XxBD5/DnWUFxKttNb555+qzM77Vx9KhMKn7fZpdHBbByu5tdtOFnYsJDjta33QtRBiU7zHRs/lsD1+KXMb8rXWFyE2v/9mousoF/0TB0HxSmud/xMfp107ew1OXQsm7A3TBBW49b5BGfD20uFk6q7Engm/Gg3ThVXGvY5X6m0LXefWdTy58SbCuYUOGMtjcUaL0z7bQfPY2Y73qLmAYKW3liEfZC34dms8+Ux3ShJNP/TItSOVw4TCQPhcjzysPV1Ye7qw9nRh7enC2tOFtacLa08X1p4urD1hlnZyvlqt5k6BBLdvOXOnwczDf0x4MXNXVvhGAAAAAElFTkSuQmCC"},207:function(t,n,a){"use strict";a.r(n);var s=a(0),e=Object(s.a)({},function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"设计简要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设计简要","aria-hidden":"true"}},[t._v("#")]),t._v(" 设计简要")]),t._v(" "),s("h2",{attrs:{id:"线程控制块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线程控制块","aria-hidden":"true"}},[t._v("#")]),t._v(" 线程控制块")]),t._v(" "),s("p",[t._v("在 "),s("strong",[t._v("MadOS")]),t._v(" 的设计中，每个线程的信息都记录在一个线程控制块中:")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("_MadTCB_t")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Kernel")]),t._v("\n    MadStk_t  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("pStk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadU8     prio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadU8     state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadTim_t  timeCnt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadTim_t  timeCntRemain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadVptr   msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadUint   eventMask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadU16    rdyg_bit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadU16    rdy_bit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadRdyG_t "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("xCB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MadU8     err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Posix")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("       posix_errno"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" MadTCB_t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("div",{staticClass:"tip custom-block"},[s("p",[t._v("刚启动时，系统中实际上只有一个线程 --- "),s("strong",[t._v("空闲线程")]),t._v("。"),s("br"),t._v("\n系统运行时，它负责在其余线程都未就绪时“消磨时间”，所以其具有最低优先级。")])]),t._v(" "),s("h2",{attrs:{id:"线程切换流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线程切换流程","aria-hidden":"true"}},[t._v("#")]),t._v(" 线程切换流程")]),t._v(" "),s("center",[s("br"),s("img",{attrs:{src:a(187)}}),s("br"),t._v(" "),s("div",{staticStyle:{color:"black"}},[t._v("切换线程即切换堆栈")])]),t._v(" "),s("h2",{attrs:{id:"线程就绪"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线程就绪","aria-hidden":"true"}},[t._v("#")]),t._v(" 线程就绪")]),t._v(" "),s("p",[t._v("各线程优先级存在差异，优先级低的线程若想运行，必然等优先级高的线程因某种原因挂起。寻找最优就绪线程最简单的方法即：将所有的线程控制块按顺序排列，每个线程控制块中有一个标志标明线程是否就绪，查找时从前向后查找每个线程控制块，遇到就绪的线程立即停止查找，停止处即最优就绪线程。但，该方式有两个缺陷：")]),t._v(" "),s("ul",[s("li",[t._v("找到即停的方式没有确定的查找时间，系统运行时线程频繁切换，最终系统损失掉实时特性；")]),t._v(" "),s("li",[t._v("顺序查找算法非常费时，系统运行时线程频繁切换，效率损失严重。")])]),t._v(" "),s("p",[t._v("MadOS 采用的是“"),s("strong",[t._v("就绪表")]),t._v("”机制，假设：")]),t._v(" "),s("ul",[s("li",[t._v("系统最大线程数为 8；")]),t._v(" "),s("li",[t._v("最高优先级为 0，最低优先级为 7。")])]),t._v(" "),s("p",[t._v("简单来说，如果系统内最大线程数设置为 8，那就定义一个包含 8Bit 的数据，每一 Bit 对应一个优先级，当对应的 Bit 置 1，表示线程就绪，置 0 则表示线程挂起。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("B7")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("B6")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("B5")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("B4")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("B3")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("B2")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("B1")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("B0")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("0/1")])])])]),t._v(" "),s("p",[t._v("可以看出:")]),t._v(" "),s("ul",[s("li",[t._v("当 B0 被置 1，此时不管剩余 Bit 为何值，最优就绪线程的优先级就是 0。")]),t._v(" "),s("li",[t._v("当 B0 为 0，B1 为 1，此时不管剩余 Bit 为何值，最优就绪线程的优先级就是 1。")]),t._v(" "),s("li",[t._v("依次类推……")])]),t._v(" "),s("p",[t._v("利用这样的规律，可以制作一张表，使得输入是 8Bit 数据的值，而输出则是最优就绪线程的优先级:"),s("br"),t._v(" "),s("center",[s("img",{attrs:{src:a(188)}}),s("br"),t._v(" "),s("div",{staticStyle:{color:"black"}},[t._v("就绪表")])])],1),t._v(" "),s("p",[t._v("注：因为空闲线程总是就绪的，所以 8Bit 数据的值一定不会为 0，因此第一个元素可以是任意数。")]),t._v(" "),s("p",[t._v("这张表，即就绪查找表，的制作规律是：从 8Bit 数据的右向左，记录连续 0 的个数 Cnt，Cnt 就是当前 8Bit 数据值对应的最高优先级。上表就是笔者利用该规律，编写了一个小程序，自动输出的。在代码中，将该表中的数据，依据自左向右，自上向下的顺序定义为一个一维数组，即可通过数组快速索引优先级。")]),t._v(" "),s("p",[t._v("可以看出，8Bit 数据只能表示出 8 个线程，去掉一个空闲线程，实际可用的只剩下了 7 个线程，这对于一个系统来说，太局限了。因此，在 MadOS 中，将上述的 8Bit 数据扩展为 16Bit，使得一个数据可以表示 16 个线程，在此基础上，MadOS 再加入线程分组的机制，定义一个优先级组和一个优先级数组:")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("MadU16 MadThreadRdyGrp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nMadU16 MadThreadRdy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MAD_THREAD_RDY_NUM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// MAD_THREAD_RDY_NUM 视最大线程数而定。")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("center",[s("img",{attrs:{src:a(189)}}),s("br"),t._v(" "),s("div",{staticStyle:{color:"black"}},[t._v("优先级分组示意")])]),t._v(" "),s("ul",[s("li",[t._v("左侧一列表示优先级组，用于查找优先级的高 4Bit --- prio_h")]),t._v(" "),s("li",[t._v("得到 prio_h，再到对应的组中查找优先级的低 4Bit --- prio_l")]),t._v(" "),s("li",[t._v("所得优先级: prio = (prio_h << 4) + prio_l")])]),t._v(" "),s("p",[t._v("这样做使得优先级的最大值扩展为 256，对于大多数的应用来说，已经足够了。但，这样做却带来另一个问题，即在制作就绪查找表时，需要 65536(16Bit 数的最大值)字节的存储空间，对于资源相对有限的单片机，这个结果是灾难性的。")]),t._v(" "),s("p",[t._v("MadOS 的做法是“因地制宜”:")]),t._v(" "),s("ul",[s("li",[t._v("如果使用的是 ARM Cortex M0/3/4 系列单片机，则可以利用其特有的两条汇编指令，按照生成就绪查找表的原理，直接查询优先级:")])]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("define")]),t._v(" madUnRdyMap(res, src) { res = src; __asm{ rbit res, res; clz res, res; } }")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("如果使用的单片机没有上述类似的汇编指令，则可以选择将优先级组与优先级数组的位宽降至8Bit，这样最大线程数变为 64，对于一般应用也是足够的。或者，选择牺牲少许性能，用代码重现 ARM Cortex M0/3/4 系列单片机特有的那两条汇编指令。")])]),t._v(" "),s("p",[t._v("利用就绪表机制，每次查找最优就绪线程都只执行一次查表操作，而查表操作的时间是确定的。")]),t._v(" "),s("h2",{attrs:{id:"动态内存管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动态内存管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 动态内存管理")]),t._v(" "),s("p",[t._v("动态内存管理是所有编程人员的“梦魇”，在大多数实时操作系统中，要么并未包含该模块，要么则是采用比较保守的“块分配”模式，前者直接将问题抛给应用编程人员，后者则使得内存大量浪费。")]),t._v(" "),s("p",[t._v("MadOS 采用“堆叠”式的动态内存分配方式。每一块被分配内存的开头由一个数据结构占据:")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("_MadMemHead_t")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    MadUint               size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 内存块的尺寸，单位为字节。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("_MadMemHead_t")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("next"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下一块内存块的首地址。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" MadMemHead_t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("每一块被分配的内存，以单链表的形式，按照内存块首地址值的升序，连接在一起。")]),t._v(" "),s("p",[t._v("欲分配内存时，MadOS 从内存堆首地址开始扫描，以内存堆尾地址作为结束，查找相邻两个块之间的可用空间，如果比需求尺寸大，则在该块空间上“割”出所需空间：\n"),s("center",[s("img",{attrs:{src:a(190)}}),s("br"),t._v(" "),s("div",{staticStyle:{color:"black"}},[t._v("动态内存堆示意")])]),t._v("\n如果尺寸不足，则继续向后扫描，如果所有的可用空间都小于所需的尺寸，则分配失败。")],1),t._v(" "),s("p",[t._v("MadMemHead_t 是供内存管理模块所用，实际返回给调用者的内存块首地址则是结构体:\n"),s("center",[s("img",{attrs:{src:a(191)}})]),t._v("\n中“内存块”的首地址。另外，在 MadOS 的动态内存分配函数中一律按照所使用的单片机的内存地址对齐方式进行分配，实际分配的内存大小:")],1),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 字节对齐处理"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sizeof")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MadMemHead_t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 字节对齐处理"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("用户所需字节数"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("例如，ARM Cortex M3 是 4 字节对齐，那么当用户需要分配 29 字节内存时，分配成功的情况下，实际分配的内存字节数为，8 + 32 = 40 字节，用户实际可用为 32 字节。在后续模块说明中会看到，MadOS 专门设计的 API 可以利用参数返回实际可用的字节数。")]),t._v(" "),s("p",[t._v("按照地址对齐方式分配内存的最大优点是提高程序效率。因为，单片机一般都具有与其对齐方式相匹配的汇编指令，然而，如果内存地址并未做对齐处理，代码编译时，某些编译器会生成按单字节处理的代码，原本一条指令可以完成的工作，则变成多条指令去完成，当内存块比较大时，性能方面的损失将陡增。")]),t._v(" "),s("p",[t._v("所有被分配的内存块，用一条单链表相连，当需要回收已分配的内存时，只需将对应的节点从单链表中删除即可。回收内存时，首先是将欲回收的指针与链表中的指针做比较，如果其存在于链表中，则将对应节点删除，如果其不存在于链表中，则忽略回收操作。这样的方式可以极大的避免误回收操作，例如，当两个线程同时回收同一块内存时，后进行的回收操作将被忽略。")]),t._v(" "),s("h2",{attrs:{id:"快速缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速缓存","aria-hidden":"true"}},[t._v("#")]),t._v(" 快速缓存")]),t._v(" "),s("p",[t._v("快速缓存是建立在动态内存管理之上的伪动态内存管理机制。用于快速分配、回收那些经常被反复使用的内存块，以便提升系统的整体运行效率。")]),t._v(" "),s("p",[t._v("使用快速缓存时，一个快速缓存池首先被建立，每次应用需要动态内存时，都从该快速缓存池中“拿走”一个或多个固定大小的分块，当应用不再需要动态内存时，再将这些固定大小的分块“放回”快速缓存池。")]),t._v(" "),s("p",[t._v("快速缓存机制实际上是一种“以空间换时间”的策略。某块内存作为快速缓存池被分配给某个应用后，即便该应用完全不使用该快速缓存池，该块内存也无法被其他应用使用。")]),t._v(" "),s("h2",{attrs:{id:"指向指针的指针"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指向指针的指针","aria-hidden":"true"}},[t._v("#")]),t._v(" 指向指针的指针")]),t._v(" "),s("p",[t._v("为了保证数据一致性，通常使用指针(以下简称 p)来访问一个数据块。例如 MadOS 中许多功能控制块(以下简称 block)的建立函数都是返回一个指向该 block 数据的指针。")]),t._v(" "),s("p",[t._v("当需要删除 block 时，如果是以 p 作为实参传入删除函数，那么 block 所占的内存是可以正确释放的，但是，想要将指向 block 的指针清 0 是无法做到的，因为删除函数中的形参与实参 p 所在的内存位置是不同的，使形参等于 0 并不能导致实参也变为 0。")]),t._v(" "),s("p",[t._v("通常，删除 block 时，同时需要将 p 清 0，以保证不会有“野指针”留在内存当中造成隐患。另外，在诸如 LwIP、FatFS 等第三方模块中，也要求删除 block 时能够同时将 p 清 0。")]),t._v(" "),s("p",[t._v("因此，MadOS 中对 block 进行操作的函数一律是以指向 p 的指针(即&p)作为实参传入的，如此，在\n函数中只需*p = 0，即可将 p 清 0。")]),t._v(" "),s("h2",{attrs:{id:"特殊信号量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特殊信号量","aria-hidden":"true"}},[t._v("#")]),t._v(" 特殊信号量")]),t._v(" "),s("p",[t._v("使用 sem = madSemCreate(0)将会建立一个特殊的信号量 sem:")]),t._v(" "),s("ul",[s("li",[t._v("每次调用 madSemRelease(&sem) 时：\n"),s("ul",[s("li",[t._v("若无线程正在等待 sem，那么该操作“什么也不做”；")]),t._v(" "),s("li",[t._v("若有线程正在等待 sem，正常释放信号量以恢复一个正在等待该 sem 的线程。")])])]),t._v(" "),s("li",[t._v("每次调用 madSemWait(&sem, x) 时，都将使当前线程进入等待 sem 的状态，从而挂起当前线程。")])]),t._v(" "),s("h2",{attrs:{id:"双堆栈机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#双堆栈机制","aria-hidden":"true"}},[t._v("#")]),t._v(" 双堆栈机制")]),t._v(" "),s("p",[t._v("为了避免中断嵌套带来的麻烦，一般的内核会记录中断嵌套层数，以便正确入 / 出栈，这种做法会导致内核出现运行效率下降、时间不确定性、线程堆栈溢出风险。")]),t._v(" "),s("p",[t._v("MadOS 中，所有中断共用同一个堆栈，该堆栈独立于所有的线程堆栈，即双堆栈机制:")]),t._v(" "),s("ul",[s("li",[t._v("由于中断函数不使用线程堆栈，线程堆栈使用情况非常稳定，可完全避免非设计溢出。")]),t._v(" "),s("li",[t._v("由于不用关心中断嵌套层数，即无需为每次中断单独入 / 出栈，整体运行效率大幅提高。")]),t._v(" "),s("li",[t._v("由于不用关心中断嵌套层数，中断损耗极低，大幅降低时间不确定性。")])])],1)},[],!1,null,null,null);n.default=e.exports}}]);